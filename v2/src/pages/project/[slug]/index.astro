---
import projectsApi from '../../../api/projects/projects-api';
import ProjectsLayout from '../../../layouts/ProjectsLayout.astro';
import RenderMarkdown from '../../../components/RenderMarkdown.astro';
import ProjectHeader from '../../../ui/project/ProjectHeader.astro';

export async function getStaticPaths() {
	const projects = await projectsApi.getProjectsSlug();

	return projects.map((project) => ({ params: { slug: project.slug } }));
}

const { slug } = Astro.params;

const project = await projectsApi.getProjectBySlug(slug);

// Set Cache-Control headers for CDN caching
Astro.response.headers.set('Cache-Control', 'public, s-maxage=60, stale-while-revalidate=30');
---

<ProjectsLayout project={project}>
	<ProjectHeader project={project} />
	<RenderMarkdown
		className="mx-auto px-5 sm:px-12 py-5"
		content={project.content?.html}
	/>
</ProjectsLayout>
